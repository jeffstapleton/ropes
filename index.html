<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Church Logo Builder</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f5f5;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 30px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .controls {
            background: #fafafa;
            padding: 30px;
            border-right: 1px solid #e0e0e0;
        }

        .preview-area {
            padding: 30px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 600px;
        }

        .control-group {
            margin-bottom: 25px;
        }

        .control-group h3 {
            font-size: 14px;
            font-weight: 600;
            color: #333;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .control-group select {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            background: white;
        }

        .color-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
        }

        .color-option {
            width: 100%;
            height: 35px;
            border: 2px solid transparent;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .color-option:hover {
            transform: scale(1.05);
        }

        .color-option.selected {
            border-color: #333;
            box-shadow: 0 0 0 2px rgba(51, 51, 51, 0.2);
        }

        .layout-options {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 8px;
        }

        .layout-btn {
            padding: 10px;
            border: 2px solid #ddd;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            text-align: center;
            font-size: 12px;
            transition: all 0.2s ease;
        }

        .layout-btn:hover {
            border-color: #999;
        }

        .layout-btn.selected {
            border-color: #333;
            background: #f0f0f0;
        }

        .logo-preview {
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 40px;
            background: 
                linear-gradient(45deg, #f0f0f0 25%, transparent 25%), 
                linear-gradient(-45deg, #f0f0f0 25%, transparent 25%), 
                linear-gradient(45deg, transparent 75%, #f0f0f0 75%), 
                linear-gradient(-45deg, transparent 75%, #f0f0f0 75%);
            background-size: 20px 20px;
            background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .download-section {
            width: 100%;
        }

        .download-group {
            margin-bottom: 20px;
        }

        .download-group h4 {
            font-size: 14px;
            margin-bottom: 10px;
            color: #666;
        }

        .download-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 8px;
        }

        .download-btn {
            padding: 8px 12px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: background 0.2s ease;
        }

        .download-btn:hover {
            background: #0056b3;
        }

        .download-btn.jpg {
            background: #28a745;
        }

        .download-btn.jpg:hover {
            background: #1e7e34;
        }

        #logoSVG {
            max-width: 500px;
            max-height: 300px;
        }

        .bg-color-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 6px;
        }

        .bg-color-option {
            width: 100%;
            height: 25px;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
        }

        .bg-color-option.selected {
            border-width: 2px;
            border-color: #333;
        }

         /* Responsive adjustments for screens smaller than 769px (typical tablet/mobile breakpoint) */
         @media (max-width: 768px) {
            body {
                padding: 10px; /* Reduce overall padding on smaller screens */
            }

            .container {
                grid-template-columns: 1fr; /* Stack columns into a single column */
                gap: 20px; /* Adjust gap between stacked sections */
                box-shadow: none; /* Remove shadow for a cleaner mobile look */
            }

            .controls {
                border-right: none; /* Remove right border */
                border-bottom: 1px solid #e0e0e0; /* Add a bottom border to separate controls from preview */
                padding: 20px; /* Adjust padding */
            }

            .preview-area {
                padding: 20px; /* Adjust padding */
                min-height: auto; /* Allow height to adjust naturally */
            }

            .control-group {
                margin-bottom: 20px; /* Adjust spacing between control groups */
            }

            .control-group h3 {
                margin-bottom: 8px; /* Adjust spacing below headers */
            }

            .color-grid {
                grid-template-columns: repeat(4, 1fr); /* More columns for color options on mobile */
                gap: 6px;
            }

            .bg-color-grid {
                grid-template-columns: repeat(5, 1fr); /* More columns for background colors */
                gap: 4px;
            }

            .layout-options {
                grid-template-columns: repeat(auto-fit, minmax(80px, 1fr)); /* Auto-fit layout buttons */
            }

            .logo-preview {
                margin-bottom: 20px; /* Adjust margin below the preview box */
                padding: 20px; /* Adjust padding inside the preview box */
            }

            #logoSVG {
                max-width: 100%; /* Ensure SVG scales down within its container */
                max-height: 250px; /* Set a max height to prevent it from getting too tall */
                height: auto; /* Maintain aspect ratio */
            }

            .download-buttons {
                grid-template-columns: repeat(2, 1fr); /* Two columns for download buttons */
            }
        }

        /* Optional: Further adjustments for very small screens (e.g., iPhone SE) */
        @media (max-width: 480px) {
            .color-grid,
            .bg-color-grid {
                grid-template-columns: repeat(3, 1fr); /* Fewer columns if needed for very small screens */
            }

            .download-buttons {
                grid-template-columns: 1fr; /* Stack download buttons vertically on very small screens */
            }
        }

    </style>
</head>
<body>
    <div class="container">
        <div class="controls">
            <div class="control-group">
                <h3>Logo Mark</h3>
                <select id="logoMark">
                    <option value="fbcMark" selected>Primary 2 Color</option>
                    <option value="steeple">Steeple</option>
                    <option value="primary1Color">Primary 1 Color</option>
                    <option value="fbcr">FBCR</option>
                    <option value="fbc">FBC</option>
                </select>
            </div>

            <div class="control-group" id="topMarkColorGroup" style="display: block;">
                <h3>Top Mark Color</h3>
                <div class="color-grid" id="topMarkColors"></div>
            </div>

            <div class="control-group">
                <h3 id="logoColorLabel">Bottom Mark Color</h3>
                <div class="color-grid" id="logoColors"></div>
            </div>

            <div class="control-group">
                <h3>Text Option</h3>
                <select id="textOption">
                    <option value="ropes" selected>Ropes</option>
                    <option value="ropesFBC">Ropes + First Baptist Church</option>
                </select>
            </div>

            <div class="control-group">
                <h3>Text Color</h3>
                <div class="color-grid" id="textColors"></div>
            </div>

            <div class="control-group">
                <h3>Layout</h3>
                <div class="layout-options">
                    <div class="layout-btn selected" data-layout="horizontal">
                        Horizontal
                    </div>
                    <div class="layout-btn" data-layout="vertical">
                        Stacked
                    </div>
                    <div class="layout-btn" data-layout="logoOnly">
                        Logo Mark Only
                    </div>
                </div>
            </div>

            <div class="control-group">
                <h3>Background for JPG Export</h3>
                <div class="bg-color-grid" id="exportBackgroundColors"></div>
            </div>
        </div>

        <div class="preview-area">
            <div class="logo-preview">
                <svg id="logoSVG" width="1200" height="800" viewBox="0 0 1200 800">
                    <g id="logoGroup"></g>
                    <g id="textGroup"></g>
                </svg>
            </div>

            <div class="download-section">
                <div class="download-group">
                    <h4>PNG Downloads (Transparent)</h4>
                    <div class="download-buttons">
                        <button class="download-btn" onclick="downloadPNG(200)">200px</button>
                        <button class="download-btn" onclick="downloadPNG(500)">500px</button>
                        <button class="download-btn" onclick="downloadPNG(1000)">1000px</button>
                        <button class="download-btn" onclick="downloadPNG(1920)">1920px</button>
                    </div>
                </div>

                <div class="download-group">
                    <h4>JPG Downloads (Colored Background)</h4>
                    <div class="download-buttons">
                        <button class="download-btn jpg" onclick="downloadJPG('square')">Square</button>
                        <button class="download-btn jpg" onclick="downloadJPG('landscape')">1920x1080</button>
                        <button class="download-btn jpg" onclick="downloadJPG('portrait')">1080x1920</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Your church brand colors
        const brandColors = [
            '#339c5e', // Ropes Green
            '#2d513f', // Shade Green
            '#414a56', // Navy
            '#e0d5ca', // Tan
            '#ffffff', // White
            '#ffa500', // Shock Yellow
            '#222222',  // New Black
            'transparent_bg' // Transparent Background
        ];

        let currentConfig = {
            logoMark: 'fbcMark',
            logoColor: brandColors[2], // Navy
            topMarkColor: brandColors[0], // Ropes Green
            textOption: 'ropes',
            textColor: brandColors[6], // New Black
            layout: 'horizontal',
            exportBackgroundColor: 'transparent_bg' // NEW: Default to transparent
        };

        const logoMarks = {
            circle: `<circle cx="600" cy="400" r="100" fill="LOGO_COLOR"/>`,
            fbcMark: {
                horizontal: `<rect x="62.55" y="268.98" width="262.71" height="262.71" rx="131.35" ry="131.35" fill="BOTTOM_COLOR"/>
                             <g fill="TOP_COLOR">
                               <path d="M233.82,397.59c16.38-6.16,28.03-21.96,28.03-40.49h0c0-28.03-22.72-50.75-50.75-50.75h-11.87c-1.83,0-3.32,1.49-3.32,3.32v38.49c0,1.83,1.49,3.32,3.32,3.32h21.06c4.65,0,8.91,3.14,9.78,7.7,1.17,6.13-3.5,11.49-9.41,11.49h-21.43c-1.83,0-3.32,1.49-3.32,3.32v77.82c0,39.19,44.29,39.19,65.94,39.19h0s0,0,0,0v-54.82c0-17.75-11.81-32.74-28-37.56-.52-.15-.54-.83-.04-1.02Z"/>
                               <path d="M158.08,387.6c0-1.02-.84-1.82-1.78-1.82h-6.93v3.73h6.93c.93,0,1.78-.84,1.78-1.91Z"/>
                               <path d="M156.57,396.8h-7.2v4.04h7.2c1.29,0,2.09-.89,2.09-2s-.8-2.05-2.09-2.05Z"/>
                               <path d="M173.4,370.67h-38.64c-1.83,0-3.32,1.49-3.32,3.32v38.64c0,1.83,1.49,3.32,3.32,3.32h38.64c1.83,0,3.32-1.49,3.32-3.32v-38.64c0-1.83-1.49-3.32-3.32-3.32ZM159.01,408.13h-18.62v-29.64h18c6.13,0,8.8,4.09,8.8,7.55,0,3.69-2.18,6.18-5.07,6.8,3.2.49,5.64,3.42,5.64,7.24,0,4.13-2.8,8.04-8.75,8.04Z"/>
                               <path d="M173.41,306.19h-38.65c-1.83,0-3.31,1.49-3.31,3.32v38.65c0,1.83,1.49,3.32,3.31,3.32h38.65c1.83,0,3.31-1.49,3.31-3.32v-38.65c0-1.83-1.49-3.32-3.31-3.32ZM165.32,321.48h-13.51v3.47h13.2v7.47h-13.2v11.24h-8.98v-29.64h22.49v7.47Z"/>
                               <path d="M173.41,435.15h-38.65c-1.83,0-3.31,1.49-3.31,3.32v38.65c0,1.83,1.49,3.32,3.31,3.32h38.65c1.83,0,3.31-1.49,3.31-3.32v-38.65c0-1.83-1.49-3.32-3.31-3.32ZM155.28,465.21c2.89,0,5.2-2,5.96-4.31l7.73,3.56c-1.73,3.96-5.69,8.67-13.69,8.67-9.07,0-16.09-6.22-16.09-15.33s7.02-15.33,16.09-15.33c8,0,11.91,4.53,13.69,8.62l-7.73,3.6c-.76-2.31-3.07-4.31-5.96-4.31-4.09,0-6.98,3.29-6.98,7.42s2.89,7.42,6.98,7.42Z"/>
                             </g>`,
                vertical: `<rect x="468.65" y="132.35" width="262.71" height="262.71" rx="131.35" ry="131.35" fill="BOTTOM_COLOR"/>
                           <g fill="TOP_COLOR">
                             <path d="M639.91,260.96c16.38-6.16,28.03-21.96,28.03-40.49h0c0-28.03-22.72-50.75-50.75-50.75h-11.87c-1.83,0-3.32,1.49-3.32,3.32v38.49c0,1.83,1.49,3.32,3.32,3.32h21.06c4.65,0,8.91,3.14,9.78,7.7,1.17,6.13-3.5,11.49-9.41,11.49h-21.43c-1.83,0-3.32,1.49-3.32,3.32v77.82c0,39.19,44.29,39.19,65.94,39.19h0s0,0,0,0v-54.82c0-17.75-11.81-32.74-28-37.56-.52-.15-.54-.83-.04-1.02Z"/>
                             <path d="M564.18,250.97c0-1.02-.84-1.82-1.78-1.82h-6.93v3.73h6.93c.93,0,1.78-.84,1.78-1.91Z"/>
                             <path d="M562.67,260.17h-7.2v4.04h7.2c1.29,0,2.09-.89,2.09-2s-.8-2.05-2.09-2.05Z"/>
                             <path d="M579.5,234.04h-38.64c-1.83,0-3.32,1.49-3.32,3.32v38.64c0,1.83,1.49,3.32,3.32,3.32h38.64c1.83,0,3.32-1.49,3.32-3.32v-38.64c0-1.83-1.49-3.32-3.32-3.32ZM565.11,271.5h-18.62v-29.64h18c6.13,0,8.8,4.09,8.8,7.55,0,3.69-2.18,6.18-5.07,6.8,3.2.49,5.64,3.42,5.64,7.24,0,4.13-2.8,8.04-8.75,8.04Z"/>
                             <path d="M579.5,169.56h-38.65c-1.83,0-3.31,1.49-3.31,3.32v38.65c0,1.83,1.49,3.32,3.31,3.32h38.65c1.83,0,3.31-1.49,3.31-3.32v-38.65c0-1.83-1.49-3.32-3.31-3.32ZM571.42,184.85h-13.51v3.47h13.2v7.47h-13.2v11.24h-8.98v-29.64h22.49v7.47Z"/>
                             <path d="M579.5,298.52h-38.65c-1.83,0-3.31,1.49-3.31,3.32v38.65c0,1.83,1.49,3.32,3.31,3.32h38.65c1.83,0,3.31-1.49,3.31-3.32v-38.65c0-1.83-1.49-3.32-3.31-3.32ZM561.38,328.58c2.89,0,5.2-2,5.96-4.31l7.73,3.56c-1.73,3.96-5.69,8.67-13.69,8.67-9.07,0-16.09-6.22-16.09-15.33s7.02-15.33,16.09-15.33c8,0,11.91,4.53,13.69,8.62l-7.73,3.6c-.76-2.31-3.07-4.31-5.96-4.31-4.09,0-6.98,3.29-6.98,7.42s2.89,7.42,6.98,7.42Z"/>
                           </g>`,
                logoOnly: `<rect x="284.35" y="84.35" width="631.3" height="631.3" rx="315.65" ry="315.65" fill="BOTTOM_COLOR"/>
                           <g fill="TOP_COLOR">
                             <path d="M695.91,393.41c39.36-14.81,67.37-52.78,67.37-97.31h0c0-67.35-54.6-121.95-121.95-121.95h-28.53c-4.41,0-7.98,3.57-7.98,7.98v92.48c0,4.41,3.57,7.98,7.98,7.98h50.61c11.16,0,21.41,7.55,23.5,18.51,2.81,14.73-8.4,27.6-22.62,27.6h-51.49c-4.41,0-7.98,3.57-7.98,7.98v187c0,94.17,106.44,94.17,158.45,94.17h0s0,0,0,0v-131.75c0-42.66-28.37-78.69-67.28-90.26-1.24-.37-1.3-1.99-.09-2.45Z"/>
                             <path d="M513.91,369.4c0-2.46-2.03-4.38-4.27-4.38h-16.66v8.97h16.66c2.24,0,4.27-2.03,4.27-4.59Z"/>
                             <path d="M510.28,391.5h-17.3v9.72h17.3c3.1,0,5.02-2.14,5.02-4.81s-1.92-4.91-5.02-4.91Z"/>
                             <path d="M550.73,328.72h-92.86c-4.41,0-7.98,3.57-7.98,7.98v92.86c0,4.41,3.57,7.98,7.98,7.98h92.86c4.41,0,7.98-3.57,7.98-7.98v-92.86c0-4.41-3.57-7.98-7.98-7.98ZM516.16,418.73h-44.75v-71.23h43.25c14.74,0,21.15,9.82,21.15,18.16,0,8.86-5.23,14.84-12.17,16.34,7.69,1.17,13.56,8.22,13.56,17.4,0,9.93-6.73,19.33-21.04,19.33Z"/>
                             <path d="M550.75,173.77h-92.89c-4.39,0-7.97,3.57-7.97,7.97v92.89c0,4.39,3.57,7.97,7.97,7.97h92.89c4.39,0,7.96-3.57,7.96-7.97v-92.89c0-4.39-3.57-7.97-7.96-7.97ZM531.32,210.51h-32.47v8.33h31.72v17.94h-31.72v27.02h-21.57v-71.23h54.04v17.94Z"/>
                             <path d="M550.75,483.66h-92.89c-4.39,0-7.97,3.57-7.97,7.97v92.89c0,4.39,3.57,7.97,7.97,7.97h92.89c4.39,0,7.96-3.57,7.96-7.97v-92.89c0-4.39-3.57-7.97-7.96-7.97ZM507.19,555.9c6.94,0,12.5-4.81,14.31-10.36l18.58,8.54c-4.17,9.51-13.67,20.83-32.89,20.83-21.79,0-38.66-14.95-38.66-36.85s16.87-36.85,38.66-36.85c19.22,0,28.62,10.89,32.89,20.72l-18.58,8.65c-1.82-5.55-7.37-10.36-14.31-10.36-9.83,0-16.77,7.9-16.77,17.83s6.94,17.83,16.77,17.83Z"/>
                           </g>`
            },
            steeple: {
                horizontal: `<g fill="LOGO_COLOR">
                              <path d="M161.32,407.29h13.41c.63,0,1.15.52,1.15,1.15v13.41c0,.64-.52,1.15-1.15,1.15h-13.41c-.63,0-1.15-.52-1.15-1.15v-13.41c0-.64.52-1.15,1.15-1.15Z"/>
                              <path d="M161.32,429.34h13.41c.63,0,1.15.52,1.15,1.15v13.41c0,.64-.52,1.15-1.15,1.15h-13.41c-.63,0-1.15-.52-1.15-1.15v-13.41c0-.64.52-1.15,1.15-1.15Z"/>
                              <path d="M161.32,450.66h13.41c.63,0,1.15.52,1.15,1.15v13.41c0,.64-.52,1.15-1.15,1.15h-13.41c-.63,0-1.15-.52-1.15-1.15v-13.41c0-.64.52-1.15,1.15-1.15Z"/>
                              <path d="M145.97,407.29l-6.45-12.14,20.86-11.08.2-4.9-29.11,15.46-6.45-12.14,36.21-19.23,3.65-88.87c-58.28,13.36-101.88,65.65-101.88,127.92,0,58.45,38.42,108.09,91.33,125.02v-124.49l-8.36,4.44Z"/>
                              <path d="M325.47,402.31c0-72.36-58.87-131.23-131.23-131.23-7.89,0-15.62.7-23.13,2.04l3.41,83.09,19.72-10.47,69.2,36.76-6.45,12.14-62.76-33.33-19.09,10.14.19,4.69,18.9-10.04,54.72,29.06-6.45,12.14-8.36-4.44v124.49c52.91-16.93,91.33-66.57,91.33-125.02Z"/>
                            </g>`,
                vertical: `<g fill="LOGO_COLOR">
                            <path d="M577.4,260.67h13.41c.63,0,1.15.52,1.15,1.15v13.41c0,.64-.52,1.15-1.15,1.15h-13.41c-.63,0-1.15-.52-1.15-1.15v-13.41c0-.64.52-1.15,1.15-1.15Z"/>
                            <path d="M577.4,282.72h13.41c.63,0,1.15.52,1.15,1.15v13.41c0,.64-.52,1.15-1.15,1.15h-13.41c-.63,0-1.15-.52-1.15-1.15v-13.41c0-.64.52-1.15,1.15-1.15Z"/>
                            <path d="M577.4,304.04h13.41c.63,0,1.15.52,1.15,1.15v13.41c0,.64-.52,1.15-1.15,1.15h-13.41c-.63,0-1.15-.52-1.15-1.15v-13.41c0-.64.52-1.15,1.15-1.15Z"/>
                            <path d="M562.05,260.67l-6.45-12.14,20.86-11.08.2-4.9-29.11,15.46-6.45-12.14,36.21-19.23,3.65-88.87c-58.28,13.36-101.88,65.65-101.88,127.92,0,58.45,38.42,108.09,91.33,125.02v-124.49l-8.36,4.44Z"/>
                            <path d="M741.55,255.69c0-72.36-58.87-131.23-131.23-131.23-7.89,0-15.62.7-23.13,2.04l3.41,83.09,19.72-10.47,69.2,36.76-6.45,12.14-62.76-33.33-19.09,10.14.19,4.69,18.9-10.04,54.72,29.06-6.45,12.14-8.36-4.44v124.49c52.91-16.93,91.33-66.57,91.33-125.02Z"/>
                        </g>`, // Replace with your actual STACKED Steeple SVG
                logoOnly: `<g fill="LOGO_COLOR">
                            <path d="M519.87,412.43h32.24c1.53,0,2.77,1.24,2.77,2.77v32.25c0,1.53-1.24,2.77-2.77,2.77h-32.24c-1.53,0-2.77-1.24-2.77-2.77v-32.25c0-1.53,1.24-2.77,2.77-2.77Z"/>
                            <path d="M519.87,465.45h32.24c1.53,0,2.77,1.24,2.77,2.77v32.25c0,1.53-1.24,2.77-2.77,2.77h-32.24c-1.53,0-2.77-1.24-2.77-2.77v-32.25c0-1.53,1.24-2.77,2.77-2.77Z"/>
                            <path d="M519.87,516.7h32.24c1.53,0,2.77,1.24,2.77,2.77v32.25c0,1.53-1.24,2.77-2.77,2.77h-32.24c-1.53,0-2.77-1.24-2.77-2.77v-32.25c0-1.53,1.24-2.77,2.77-2.77Z"/>
                            <path d="M482.97,412.43l-15.5-29.17,50.15-26.64.48-11.77-69.97,37.16-15.5-29.17,87.04-46.23,8.78-213.64c-140.1,32.13-244.92,157.8-244.92,307.51,0,140.51,92.35,259.84,219.53,300.53v-299.25l-20.11,10.68Z"/>
                            <path d="M914.46,400.47c0-173.95-141.52-315.47-315.46-315.47-18.97,0-37.55,1.68-55.6,4.91l8.21,199.73,47.39-25.17,166.36,88.36-15.5,29.17-150.86-80.13-45.89,24.38.46,11.27,45.43-24.13,131.53,69.86-15.5,29.17-20.11-10.68v299.25c127.19-40.69,219.54-160.02,219.54-300.53Z"/>
                            </g>`, 
            },
            primary1Color: {
                horizontal: `<g fill="LOGO_COLOR">
                            <polygon points="143.15 345.06 152.12 345.06 152.12 333.82 165.31 333.82 165.31 326.36 152.12 326.36 152.12 322.9 165.62 322.9 165.62 315.43 143.15 315.43 143.15 345.06"/>
                            <path d="M162.43,394.22c2.89-.62,5.06-3.11,5.06-6.8,0-3.47-2.67-7.55-8.79-7.55h-17.99v29.63h18.61c5.95,0,8.75-3.91,8.75-8.04,0-3.82-2.44-6.75-5.64-7.24ZM149.68,387.16h6.93c.93,0,1.78.8,1.78,1.82s-.84,1.91-1.78,1.91h-6.93v-3.73ZM156.87,402.21h-7.2v-4.04h7.2c1.29,0,2.09.98,2.09,2.04s-.8,2-2.09,2Z"/>
                            <path d="M194.19,270.43h0c-72.5,0-131.28,58.78-131.28,131.28h0c0,72.5,58.78,131.28,131.28,131.28h0c72.5,0,131.28-58.78,131.28-131.28h0c0-72.5-58.78-131.28-131.28-131.28ZM177.02,478.44c0,1.83-1.49,3.31-3.31,3.31h-38.63c-1.83,0-3.31-1.49-3.31-3.31v-38.63c0-1.83,1.49-3.31,3.31-3.31h38.63c1.83,0,3.31,1.49,3.31,3.31v38.63ZM177.02,414c0,1.83-1.49,3.32-3.32,3.32h-38.62c-1.83,0-3.32-1.49-3.32-3.32v-38.62c0-1.83,1.49-3.32,3.32-3.32h38.62c1.83,0,3.32,1.49,3.32,3.32v38.62ZM177.02,349.56c0,1.83-1.49,3.31-3.31,3.31h-38.63c-1.83,0-3.31-1.49-3.31-3.31v-38.63c0-1.83,1.49-3.31,3.31-3.31h38.63c1.83,0,3.31,1.49,3.31,3.31v38.63ZM262.1,358.49c0,18.52-11.65,34.31-28.02,40.47-.5.19-.48.87.04,1.02,16.18,4.81,27.98,19.8,27.98,37.54v54.79h0,0,0c-21.63,0-65.9,0-65.9-39.17v-77.77c0-1.83,1.49-3.32,3.32-3.32h21.41c5.91,0,10.58-5.35,9.41-11.48-.87-4.56-5.13-7.7-9.77-7.7h-21.05c-1.83,0-3.32-1.49-3.32-3.32v-38.46c0-1.83,1.49-3.32,3.32-3.32h11.86c28.01,0,50.72,22.71,50.72,50.72h0Z"/>
                            <path d="M155.59,451.71c2.89,0,5.2,2,5.95,4.31l7.73-3.6c-1.78-4.09-5.69-8.62-13.68-8.62-9.06,0-16.08,6.17-16.08,15.32s7.02,15.32,16.08,15.32c8,0,11.95-4.71,13.68-8.66l-7.73-3.55c-.75,2.31-3.06,4.31-5.95,4.31-4.09,0-6.97-3.29-6.97-7.42s2.89-7.42,6.97-7.42Z"/>
                            </g>`,
                vertical: `<g fill="LOGO_COLOR">
                            <polygon points="549.46 206.65 558.43 206.65 558.43 195.42 571.63 195.42 571.63 187.95 558.43 187.95 558.43 184.49 571.94 184.49 571.94 177.03 549.46 177.03 549.46 206.65"/>
                            <path d="M568.74,255.81c2.89-.62,5.06-3.11,5.06-6.8,0-3.47-2.67-7.55-8.79-7.55h-17.99v29.63h18.61c5.95,0,8.75-3.91,8.75-8.04,0-3.82-2.44-6.75-5.64-7.24ZM555.99,248.75h6.93c.93,0,1.78.8,1.78,1.82s-.84,1.91-1.78,1.91h-6.93v-3.73ZM563.19,263.81h-7.2v-4.04h7.2c1.29,0,2.09.98,2.09,2.04s-.8,2-2.09,2Z"/>
                            <path d="M600.5,132.02h0c-72.5,0-131.28,58.78-131.28,131.28h0c0,72.5,58.78,131.28,131.28,131.28h0c72.5,0,131.28-58.78,131.28-131.28h0c0-72.5-58.78-131.28-131.28-131.28ZM583.33,340.04c0,1.83-1.49,3.31-3.31,3.31h-38.63c-1.83,0-3.31-1.49-3.31-3.31v-38.63c0-1.83,1.49-3.31,3.31-3.31h38.63c1.83,0,3.31,1.49,3.31,3.31v38.63ZM583.33,275.59c0,1.83-1.49,3.32-3.32,3.32h-38.62c-1.83,0-3.32-1.49-3.32-3.32v-38.62c0-1.83,1.49-3.32,3.32-3.32h38.62c1.83,0,3.32,1.49,3.32,3.32v38.62ZM583.33,211.16c0,1.83-1.49,3.31-3.31,3.31h-38.63c-1.83,0-3.31-1.49-3.31-3.31v-38.63c0-1.83,1.49-3.31,3.31-3.31h38.63c1.83,0,3.31,1.49,3.31,3.31v38.63ZM668.41,220.09c0,18.52-11.65,34.31-28.02,40.47-.5.19-.48.87.04,1.02,16.18,4.81,27.98,19.8,27.98,37.54v54.79h0,0,0c-21.63,0-65.9,0-65.9-39.17v-77.77c0-1.83,1.49-3.32,3.32-3.32h21.41c5.91,0,10.58-5.35,9.41-11.48-.87-4.56-5.13-7.7-9.77-7.7h-21.05c-1.83,0-3.32-1.49-3.32-3.32v-38.46c0-1.83,1.49-3.32,3.32-3.32h11.86c28.01,0,50.72,22.71,50.72,50.72h0Z"/>
                            <path d="M561.9,313.3c2.89,0,5.2,2,5.95,4.31l7.73-3.6c-1.78-4.09-5.69-8.62-13.68-8.62-9.06,0-16.08,6.17-16.08,15.32s7.02,15.32,16.08,15.32c8,0,11.95-4.71,13.68-8.66l-7.73-3.55c-.75,2.31-3.06,4.31-5.95,4.31-4.09,0-6.97-3.29-6.97-7.42s2.89-7.42,6.97-7.42Z"/>
                            </g>`,
                logoOnly: `<g fill="LOGO_COLOR">
                            <polygon points="472.34 271.85 494.6 271.85 494.6 243.96 527.34 243.96 527.34 225.44 494.6 225.44 494.6 216.84 528.11 216.84 528.11 198.33 472.34 198.33 472.34 271.85"/>
                            <path d="M520.18,393.85c7.16-1.55,12.57-7.72,12.57-16.87,0-8.6-6.61-18.74-21.83-18.74h-44.64v73.52h46.19c14.77,0,21.71-9.7,21.71-19.95,0-9.48-6.06-16.75-14-17.96ZM488.54,376.32h17.2c2.31,0,4.41,1.98,4.41,4.52s-2.09,4.74-4.41,4.74h-17.2v-9.26ZM506.4,413.69h-17.86v-10.03h17.86c3.2,0,5.18,2.43,5.18,5.07s-1.98,4.96-5.18,4.96Z"/>
                            <path d="M599,86.63h0c-179.93,0-325.8,145.86-325.8,325.8h0c0,179.93,145.86,325.8,325.8,325.8h0c179.93,0,325.8-145.86,325.8-325.8h0c0-179.93-145.86-325.8-325.8-325.8ZM556.38,602.87c0,4.54-3.69,8.22-8.22,8.22h-95.87c-4.53,0-8.22-3.69-8.22-8.22v-95.88c0-4.54,3.69-8.22,8.22-8.22h95.87c4.53,0,8.22,3.69,8.22,8.22v95.88ZM556.38,442.94c0,4.55-3.69,8.24-8.24,8.24h-95.84c-4.55,0-8.24-3.69-8.24-8.24v-95.85c0-4.55,3.69-8.24,8.24-8.24h95.84c4.55,0,8.24,3.69,8.24,8.24v95.85ZM556.38,283.03c0,4.54-3.69,8.22-8.22,8.22h-95.87c-4.53,0-8.22-3.69-8.22-8.22v-95.88c0-4.54,3.69-8.22,8.22-8.22h95.87c4.53,0,8.22,3.69,8.22,8.22v95.88ZM767.53,305.19c0,45.97-28.91,85.15-69.53,100.44-1.25.47-1.19,2.15.09,2.53,40.15,11.95,69.44,49.13,69.44,93.16v135.98h0,0,0c-53.68,0-163.55,0-163.55-97.2v-193.02c0-4.55,3.69-8.24,8.24-8.24h53.14c14.68,0,26.25-13.29,23.35-28.49-2.16-11.32-12.73-19.11-24.25-19.11h-52.24c-4.55,0-8.24-3.69-8.24-8.24v-95.46c0-4.55,3.69-8.24,8.24-8.24h29.44c69.51,0,125.87,56.35,125.87,125.87h0Z"/>
                            <path cd="M503.2,536.53c7.17,0,12.9,4.96,14.77,10.69l19.18-8.93c-4.41-10.14-14.11-21.39-33.95-21.39-22.49,0-39.9,15.32-39.9,38.03s17.42,38.03,39.9,38.03c19.84,0,29.65-11.68,33.95-21.49l-19.18-8.82c-1.87,5.73-7.61,10.69-14.77,10.69-10.14,0-17.31-8.16-17.31-18.41s7.16-18.41,17.31-18.41Z"/>
                            </g>`,
            },
            fbcr: {
                horizontal: `<g fill="LOGO_COLOR">
                            <path d="M233.82,397.59c16.38-6.16,28.03-21.96,28.03-40.49h0c0-28.03-22.72-50.75-50.75-50.75h-11.87c-1.83,0-3.32,1.49-3.32,3.32v38.49c0,1.83,1.49,3.32,3.32,3.32h21.06c4.65,0,8.91,3.14,9.78,7.7,1.17,6.13-3.5,11.49-9.41,11.49h-21.43c-1.83,0-3.32,1.49-3.32,3.32v77.82c0,39.19,44.29,39.19,65.94,39.19h0s0,0,0,0v-54.82c0-17.75-11.81-32.74-28-37.56-.52-.15-.54-.83-.04-1.02Z"/>
                            <path d="M158.08,387.6c0-1.02-.84-1.82-1.78-1.82h-6.93v3.73h6.93c.93,0,1.78-.84,1.78-1.91Z"/>
                            <path d="M156.57,396.8h-7.2v4.04h7.2c1.29,0,2.09-.89,2.09-2s-.8-2.05-2.09-2.05Z"/>
                            <path d="M173.4,370.67h-38.64c-1.83,0-3.32,1.49-3.32,3.32v38.64c0,1.83,1.49,3.32,3.32,3.32h38.64c1.83,0,3.32-1.49,3.32-3.32v-38.64c0-1.83-1.49-3.32-3.32-3.32ZM159.01,408.13h-18.62v-29.64h18c6.13,0,8.8,4.09,8.8,7.55,0,3.69-2.18,6.18-5.07,6.8,3.2.49,5.64,3.42,5.64,7.24,0,4.13-2.8,8.04-8.75,8.04Z"/>
                            <path d="M173.41,306.19h-38.65c-1.83,0-3.31,1.49-3.31,3.32v38.65c0,1.83,1.49,3.32,3.31,3.32h38.65c1.83,0,3.31-1.49,3.31-3.32v-38.65c0-1.83-1.49-3.32-3.31-3.32ZM165.32,321.48h-13.51v3.47h13.2v7.47h-13.2v11.24h-8.98v-29.64h22.49v7.47Z"/>
                            <path d="M173.41,435.15h-38.65c-1.83,0-3.31,1.49-3.31,3.32v38.65c0,1.83,1.49,3.32,3.31,3.32h38.65c1.83,0,3.31-1.49,3.31-3.32v-38.65c0-1.83-1.49-3.32-3.31-3.32ZM155.28,465.21c2.89,0,5.2-2,5.96-4.31l7.73,3.56c-1.73,3.96-5.69,8.67-13.69,8.67-9.07,0-16.09-6.22-16.09-15.33s7.02-15.33,16.09-15.33c8,0,11.91,4.53,13.69,8.62l-7.73,3.6c-.76-2.31-3.07-4.31-5.96-4.31-4.09,0-6.98,3.29-6.98,7.42s2.89,7.42,6.98,7.42Z"/>
                            </g>`,
                vertical: `<g fill="LOGO_COLOR">
                            <path d="M639.91,260.96c16.38-6.16,28.03-21.96,28.03-40.49h0c0-28.03-22.72-50.75-50.75-50.75h-11.87c-1.83,0-3.32,1.49-3.32,3.32v38.49c0,1.83,1.49,3.32,3.32,3.32h21.06c4.65,0,8.91,3.14,9.78,7.7,1.17,6.13-3.5,11.49-9.41,11.49h-21.43c-1.83,0-3.32,1.49-3.32,3.32v77.82c0,39.19,44.29,39.19,65.94,39.19h0s0,0,0,0v-54.82c0-17.75-11.81-32.74-28-37.56-.52-.15-.54-.83-.04-1.02Z"/>
                            <path d="M564.18,250.97c0-1.02-.84-1.82-1.78-1.82h-6.93v3.73h6.93c.93,0,1.78-.84,1.78-1.91Z"/>
                            <path d="M562.67,260.17h-7.2v4.04h7.2c1.29,0,2.09-.89,2.09-2s-.8-2.05-2.09-2.05Z"/>
                            <path d="M579.5,234.04h-38.64c-1.83,0-3.32,1.49-3.32,3.32v38.64c0,1.83,1.49,3.32,3.32,3.32h38.64c1.83,0,3.32-1.49,3.32-3.32v-38.64c0-1.83-1.49-3.32-3.32-3.32ZM565.11,271.5h-18.62v-29.64h18c6.13,0,8.8,4.09,8.8,7.55,0,3.69-2.18,6.18-5.07,6.8,3.2.49,5.64,3.42,5.64,7.24,0,4.13-2.8,8.04-8.75,8.04Z"/>
                            <path d="M579.5,169.56h-38.65c-1.83,0-3.31,1.49-3.31,3.32v38.65c0,1.83,1.49,3.32,3.31,3.32h38.65c1.83,0,3.31-1.49,3.31-3.32v-38.65c0-1.83-1.49-3.32-3.31-3.32ZM571.42,184.85h-13.51v3.47h13.2v7.47h-13.2v11.24h-8.98v-29.64h22.49v7.47Z"/>
                            <path d="M579.5,298.52h-38.65c-1.83,0-3.31,1.49-3.31,3.32v38.65c0,1.83,1.49,3.32,3.31,3.32h38.65c1.83,0,3.31-1.49,3.31-3.32v-38.65c0-1.83-1.49-3.32-3.31-3.32ZM561.38,328.58c2.89,0,5.2-2,5.96-4.31l7.73,3.56c-1.73,3.96-5.69,8.67-13.69,8.67-9.07,0-16.09-6.22-16.09-15.33s7.02-15.33,16.09-15.33c8,0,11.91,4.53,13.69,8.62l-7.73,3.6c-.76-2.31-3.07-4.31-5.96-4.31-4.09,0-6.98,3.29-6.98,7.42s2.89,7.42,6.98,7.42Z"/>
                           </g>`,
                logoOnly: `<g fill="LOGO_COLOR">
                            <path d="M695.91,393.41c39.36-14.81,67.37-52.78,67.37-97.31h0c0-67.35-54.6-121.95-121.95-121.95h-28.53c-4.41,0-7.98,3.57-7.98,7.98v92.48c0,4.41,3.57,7.98,7.98,7.98h50.61c11.16,0,21.41,7.55,23.5,18.51,2.81,14.73-8.4,27.6-22.62,27.6h-51.49c-4.41,0-7.98,3.57-7.98,7.98v187c0,94.17,106.44,94.17,158.45,94.17h0s0,0,0,0v-131.75c0-42.66-28.37-78.69-67.28-90.26-1.24-.37-1.3-1.99-.09-2.45Z"/>
                            <path d="M513.91,369.4c0-2.46-2.03-4.38-4.27-4.38h-16.66v8.97h16.66c2.24,0,4.27-2.03,4.27-4.59Z"/>
                            <path d="M510.28,391.5h-17.3v9.72h17.3c3.1,0,5.02-2.14,5.02-4.81s-1.92-4.91-5.02-4.91Z"/>
                            <path d="M550.73,328.72h-92.86c-4.41,0-7.98,3.57-7.98,7.98v92.86c0,4.41,3.57,7.98,7.98,7.98h92.86c4.41,0,7.98-3.57,7.98-7.98v-92.86c0-4.41-3.57-7.98-7.98-7.98ZM516.16,418.73h-44.75v-71.23h43.25c14.74,0,21.15,9.82,21.15,18.16,0,8.86-5.23,14.84-12.17,16.34,7.69,1.17,13.56,8.22,13.56,17.4,0,9.93-6.73,19.33-21.04,19.33Z"/>
                            <path d="M550.75,173.77h-92.89c-4.39,0-7.97,3.57-7.97,7.97v92.89c0,4.39,3.57,7.97,7.97,7.97h92.89c4.39,0,7.96-3.57,7.96-7.97v-92.89c0-4.39-3.57-7.97-7.96-7.97ZM531.32,210.51h-32.47v8.33h31.72v17.94h-31.72v27.02h-21.57v-71.23h54.04v17.94Z"/>
                            <path d="M550.75,483.66h-92.89c-4.39,0-7.97,3.57-7.97,7.97v92.89c0,4.39,3.57,7.97,7.97,7.97h92.89c4.39,0,7.96-3.57,7.96-7.97v-92.89c0-4.39-3.57-7.97-7.96-7.97ZM507.19,555.9c6.94,0,12.5-4.81,14.31-10.36l18.58,8.54c-4.17,9.51-13.67,20.83-32.89,20.83-21.79,0-38.66-14.95-38.66-36.85s16.87-36.85,38.66-36.85c19.22,0,28.62,10.89,32.89,20.72l-18.58,8.65c-1.82-5.55-7.37-10.36-14.31-10.36-9.83,0-16.77,7.9-16.77,17.83s6.94,17.83,16.77,17.83Z"/>
                           </g>`,
            },
            fbc: {
                horizontal: `<g fill="LOGO_COLOR">
                            <path d="M348.4,271.59h-58.3c-2.76,0-5,2.24-5,5v58.3c0,1.35.55,2.57,1.42,3.47h65.45c.87-.9,1.42-2.12,1.42-3.47v-58.3c0-2.76-2.24-5-5-5ZM335.21,294.54h-19.18v4.92h18.73v10.6h-18.73v15.96h-12.74v-42.07h31.92v10.6Z"/>
                            <path d="M348.4,365.47h-58.3c-2.76,0-5,2.24-5,5v58.3c0,2.76,2.24,5,5,5h58.3c2.76,0,5-2.24,5-5v-58.3c0-2.76-2.24-5-5-5ZM326.25,420.65h-26.43v-42.07h25.55c8.7,0,12.49,5.8,12.49,10.72,0,5.24-3.09,8.77-7.19,9.65,4.54.69,8.01,4.86,8.01,10.28,0,5.87-3.97,11.42-12.43,11.42Z"/>
                            <path d="M324.93,391.51c0-1.45-1.2-2.59-2.52-2.59h-9.84v5.3h9.84c1.33,0,2.52-1.2,2.52-2.71Z"/>
                            <path d="M322.78,404.57h-10.22v5.74h10.22c1.83,0,2.96-1.26,2.96-2.84s-1.13-2.9-2.96-2.9Z"/>
                            <path d="M348.4,460.11h-58.3c-2.76,0-5,2.24-5,5v58.3c0,2.76,2.24,5,5,5h58.3c2.76,0,5-2.24,5-5v-58.3c0-2.76-2.24-5-5-5ZM320.95,504.79c4.1,0,7.38-2.84,8.45-6.12l10.98,5.05c-2.46,5.61-8.07,12.3-19.43,12.3-12.87,0-22.83-8.83-22.83-21.76s9.97-21.76,22.83-21.76c11.35,0,16.91,6.43,19.43,12.24l-10.98,5.11c-1.07-3.28-4.35-6.12-8.45-6.12-5.8,0-9.9,4.67-9.9,10.53s4.1,10.53,9.9,10.53Z"/>
                            </g>`,
                vertical: `<g fill="LOGO_COLOR"></g>`,
                logoOnly: `<g fill="LOGO_COLOR"></g>`,
            },
            none: ''
        };

        // Text marks - using pre-positioned SVGs
        const textMarks = {
            ropes: {
                horizontal: `<g fill="TEXT_COLOR">
                              <path d="M386.73,318.6h68.49c18.29,0,32.7,4.74,43.23,14.21,10.52,9.47,15.79,22.46,15.79,38.98,0,10.69-2.23,20.08-6.68,28.17-4.45,8.1-10.73,14.41-18.82,18.94l34,61.69h-48.33l-26.23-54.16h-17.97v54.16h-43.47v-161.99ZM471,372.76c0-6.15-1.91-10.93-5.71-14.33-3.81-3.4-9.19-5.1-16.15-5.1h-18.94v38.61h18.94c7.12,0,12.55-1.7,16.27-5.1,3.72-3.4,5.59-8.09,5.59-14.09Z"/>
                              <path d="M725.04,318.6h68.49c18.46,0,32.95,4.78,43.47,14.33,10.52,9.56,15.79,22.67,15.79,39.34,0,11.17-2.39,20.89-7.16,29.14-4.78,8.26-11.58,14.66-20.4,19.19-8.83,4.53-19.23,6.8-31.21,6.8h-24.77v53.19h-44.2v-161.99ZM808.83,373c0-6.31-1.86-11.17-5.59-14.57-3.73-3.4-9.15-5.1-16.27-5.1h-17.73v39.34h17.73c7.12,0,12.55-1.7,16.27-5.1,3.72-3.4,5.59-8.26,5.59-14.57Z"/>
                              <path d="M874.16,318.6h115.12v37.89h-71.4v24.77h53.92v34.24h-53.92v27.2h77.23v37.89h-120.95v-161.99Z"/>
                              <path d="M1092.97,434.69c0-4.05-1.62-7.29-4.86-9.71-3.24-2.43-9.64-5.02-19.19-7.77l-10.93-3.4c-12.96-3.72-23.16-9.43-30.6-17.12-7.45-7.69-11.17-17.61-11.17-29.75,0-10.2,2.55-19.22,7.65-27.08,5.1-7.85,12.22-14,21.37-18.46,9.14-4.45,19.79-6.68,31.94-6.68,11.49,0,22.46,1.86,32.91,5.59,10.44,3.73,19.07,8.91,25.86,15.54l-21.61,29.39c-10.85-9.39-22.67-14.09-35.46-14.09s-18.21,3.97-18.21,11.9c0,3.56,1.58,6.44,4.74,8.62,3.16,2.19,9.19,4.66,18.09,7.41l10.2,3.16c14.73,4.53,25.9,10.89,33.52,19.06,7.61,8.18,11.41,18.5,11.41,30.97,0,10.53-2.75,19.71-8.26,27.56-5.51,7.86-13.23,13.93-23.19,18.21-9.96,4.29-21.66,6.44-35.09,6.44-12.47,0-24.25-1.99-35.34-5.95-11.09-3.96-20.93-9.67-29.51-17.12l20.16-31.33c14.89,11.98,29.95,17.97,45.17,17.97,13.6,0,20.4-4.45,20.4-13.36Z"/>
                              <path d="M615.9,358.18c23.53,0,42.66,19.14,42.66,42.66s-19.14,42.66-42.66,42.66-42.66-19.14-42.66-42.66,19.14-42.66,42.66-42.66M615.9,313.68c-48.14,0-87.16,39.03-87.16,87.17s39.03,87.17,87.16,87.17,87.17-39.03,87.17-87.17-39.03-87.17-87.17-87.17h0Z"/>
                            </g>`,
                vertical: `<g fill="TEXT_COLOR">
                             <path d="M224.05,442.76h68.49c18.29,0,32.7,4.74,43.23,14.21,10.52,9.47,15.79,22.46,15.79,38.98,0,10.69-2.23,20.08-6.68,28.17-4.45,8.1-10.73,14.41-18.82,18.94l34,61.69h-48.33l-26.23-54.16h-17.97v54.16h-43.47v-161.99ZM308.32,496.92c0-6.15-1.91-10.93-5.71-14.33-3.81-3.4-9.19-5.1-16.15-5.1h-18.94v38.61h18.94c7.12,0,12.55-1.7,16.27-5.1,3.72-3.4,5.59-8.09,5.59-14.09Z"/>
                             <path d="M562.36,442.76h68.49c18.46,0,32.95,4.78,43.47,14.33,10.52,9.56,15.79,22.67,15.79,39.34,0,11.17-2.39,20.89-7.16,29.14-4.78,8.26-11.58,14.66-20.4,19.19-8.83,4.53-19.23,6.8-31.21,6.8h-24.77v53.19h-44.2v-161.99ZM646.15,497.16c0-6.31-1.86-11.17-5.59-14.57-3.73-3.4-9.15-5.1-16.27-5.1h-17.73v39.34h17.73c7.12,0,12.55-1.7,16.27-5.1,3.72-3.4,5.59-8.26,5.59-14.57Z"/>
                             <path d="M711.48,442.76h115.12v37.89h-71.4v24.77h53.92v34.24h-53.92v27.2h77.23v37.89h-120.95v-161.99Z"/>
                             <path d="M930.29,558.85c0-4.05-1.62-7.29-4.86-9.71-3.24-2.43-9.64-5.02-19.19-7.77l-10.93-3.4c-12.96-3.72-23.16-9.43-30.6-17.12-7.45-7.69-11.17-17.61-11.17-29.75,0-10.2,2.55-19.22,7.65-27.08,5.1-7.85,12.22-14,21.37-18.46,9.14-4.45,19.79-6.68,31.94-6.68,11.49,0,22.46,1.86,32.91,5.59,10.44,3.73,19.07,8.91,25.86,15.54l-21.61,29.39c-10.85-9.39-22.67-14.09-35.46-14.09s-18.21,3.97-18.21,11.9c0,3.56,1.58,6.44,4.74,8.62,3.16,2.19,9.19,4.66,18.09,7.41l10.2,3.16c14.73,4.53,25.9,10.89,33.52,19.06,7.61,8.18,11.41,18.5,11.41,30.97,0,10.53-2.75,19.71-8.26,27.56-5.51,7.86-13.23,13.93-23.19,18.21-9.96,4.29-21.66,6.44-35.09,6.44-12.47,0-24.25-1.99-35.34-5.95-11.09-3.96-20.93-9.67-29.51-17.12l20.16-31.33c14.89,11.98,29.95,17.97,45.17,17.97,13.6,0,20.4-4.45,20.4-13.36Z"/>
                             <path d="M453.22,482.34c23.53,0,42.66,19.14,42.66,42.66s-19.14,42.66-42.66,42.66-42.66-19.14-42.66-42.66,19.14-42.66,42.66-42.66M453.22,437.84c-48.14,0-87.16,39.03-87.16,87.17s39.03,87.17,87.16,87.17,87.17-39.03,87.17-87.17-39.03-87.17-87.17-87.17h0Z"/>
                           </g>`
            },
            ropesFBC: {
                horizontal: `<g fill="TEXT_COLOR">
                              <!-- Ropes positioned for FBC layout -->
                              <path d="M386.73,290.86h68.49c18.29,0,32.7,4.74,43.23,14.21,10.52,9.47,15.79,22.46,15.79,38.98,0,10.69-2.23,20.08-6.68,28.17-4.45,8.1-10.73,14.41-18.82,18.94l34,61.69h-48.33l-26.23-54.16h-17.97v54.16h-43.47v-161.99ZM471,345.02c0-6.15-1.91-10.93-5.71-14.33-3.81-3.4-9.19-5.1-16.15-5.1h-18.94v38.61h18.94c7.12,0,12.55-1.7,16.27-5.1,3.72-3.4,5.59-8.09,5.59-14.09Z"/>
                              <path d="M725.04,290.86h68.49c18.46,0,32.95,4.78,43.47,14.33,10.52,9.56,15.79,22.67,15.79,39.34,0,11.17-2.39,20.89-7.16,29.14-4.78,8.26-11.58,14.66-20.4,19.19-8.83,4.53-19.23,6.8-31.21,6.8h-24.77v53.19h-44.2v-161.99ZM808.83,345.26c0-6.31-1.86-11.17-5.59-14.57-3.73-3.4-9.15-5.1-16.27-5.1h-17.73v39.34h17.73c7.12,0,12.55-1.7,16.27-5.1,3.72-3.4,5.59-8.26,5.59-14.57Z"/>
                              <path d="M874.16,290.86h115.12v37.89h-71.4v24.77h53.92v34.24h-53.92v27.2h77.23v37.89h-120.95v-161.99Z"/>
                              <path d="M1092.97,406.95c0-4.05-1.62-7.29-4.86-9.71-3.24-2.43-9.64-5.02-19.19-7.77l-10.93-3.4c-12.96-3.72-23.16-9.43-30.6-17.12-7.45-7.69-11.17-17.61-11.17-29.75,0-10.2,2.55-19.22,7.65-27.08,5.1-7.85,12.22-14,21.37-18.46,9.14-4.45,19.79-6.68,31.94-6.68,11.49,0,22.46,1.86,32.91,5.59,10.44,3.73,19.07,8.91,25.86,15.54l-21.61,29.39c-10.85-9.39-22.67-14.09-35.46-14.09s-18.21,3.97-18.21,11.9c0,3.56,1.58,6.44,4.74,8.62,3.16,2.19,9.19,4.66,18.09,7.41l10.2,3.16c14.73,4.53,25.9,10.89,33.52,19.06,7.61,8.18,11.41,18.5,11.41,30.97,0,10.53-2.75,19.71-8.26,27.56-5.51,7.86-13.23,13.93-23.19,18.21-9.96,4.29-21.66,6.44-35.09,6.44-12.47,0-24.25-1.99-35.34-5.95-11.09-3.96-20.93-9.67-29.51-17.12l20.16-31.33c14.89,11.98,29.95,17.97,45.17,17.97,13.6,0,20.4-4.45,20.4-13.36Z"/>
                              <path d="M615.9,330.44c23.53,0,42.66,19.14,42.66,42.66s-19.14,42.66-42.66,42.66-42.66-19.14-42.66-42.66,19.14-42.66,42.66-42.66M615.9,285.94c-48.14,0-87.16,39.03-87.16,87.17s39.03,87.17,87.16,87.17,87.17-39.03,87.17-87.17-39.03-87.17-87.17-87.17h0Z"/>
                              <!-- First Baptist Church positioned below -->
                              <path d="M412.17,514.67v-31.67h21.27v4.18h-16.52v9.26h16.19v4.18h-16.19v14.06h-4.75Z"/>
                              <path d="M448.07,514.67v-31.67h4.75v31.67h-4.75Z"/>
                              <path d="M487.62,514.67l-7.55-12.2h-5.94v12.2h-4.75v-31.67h13.34c6.03,0,10.16,3.89,10.16,9.73s-3.85,8.74-7.88,9.26l8.12,12.68h-5.51ZM482.11,487.18h-7.98v11.11h7.98c3.42,0,5.89-2.23,5.89-5.56s-2.47-5.56-5.89-5.56Z"/>
                              <path d="M508.99,506.55c2.14,2.37,5.56,4.46,9.97,4.46,5.13,0,6.93-2.61,6.93-4.89,0-3.32-3.61-4.27-7.64-5.32-5.08-1.33-10.97-2.8-10.97-9.26,0-5.22,4.61-9.02,11.21-9.02,4.89,0,8.74,1.57,11.54,4.42l-2.75,3.51c-2.42-2.56-5.74-3.7-9.16-3.7s-5.94,1.8-5.94,4.46c0,2.85,3.42,3.75,7.36,4.75,5.18,1.38,11.21,2.99,11.21,9.73,0,4.94-3.42,9.54-11.97,9.54-5.65,0-9.78-2.04-12.49-5.03l2.71-3.66Z"/>
                              <path d="M553.1,514.67v-27.49h-9.83v-4.18h24.36v4.18h-9.78v27.49h-4.75Z"/>
                              <path d="M603.82,514.67v-31.67h14.86c5.65,0,8.93,3.47,8.93,8.07,0,3.99-2.61,6.65-5.51,7.27,3.37.52,6.13,3.94,6.13,7.79,0,4.99-3.32,8.55-9.16,8.55h-15.24ZM608.57,496.44h9.21c3.18,0,4.94-1.99,4.94-4.61s-1.76-4.65-4.94-4.65h-9.21v9.26ZM608.57,510.49h9.45c3.32,0,5.32-1.9,5.32-4.99,0-2.61-1.8-4.89-5.32-4.89h-9.45v9.88Z"/>
                              <path d="M666.21,514.67l-2.56-6.55h-15.53l-2.56,6.55h-5.22l12.58-31.67h5.94l12.58,31.67h-5.22ZM655.86,487.13l-6.36,16.76h12.77l-6.41-16.76Z"/>
                              <path d="M684.73,514.67v-31.67h13.34c6.5,0,10.11,4.46,10.11,9.73s-3.66,9.73-10.11,9.73h-8.59v12.2h-4.75ZM697.46,487.18h-7.98v11.11h7.98c3.42,0,5.84-2.23,5.84-5.56s-2.42-5.56-5.84-5.56Z"/>
                              <path d="M730.32,514.67v-27.49h-9.83v-4.18h24.36v4.18h-9.78v27.49h-4.75Z"/>
                              <path d="M759.28,514.67v-31.67h4.75v31.67h-4.75Z"/>
                              <path d="M781.36,506.55c2.14,2.37,5.56,4.46,9.97,4.46,5.13,0,6.93-2.61,6.93-4.89,0-3.32-3.61-4.27-7.64-5.32-5.08-1.33-10.97-2.8-10.97-9.26,0-5.22,4.61-9.02,11.21-9.02,4.89,0,8.74,1.57,11.54,4.42l-2.75,3.51c-2.42-2.56-5.74-3.7-9.16-3.7s-5.94,1.8-5.94,4.46c0,2.85,3.42,3.75,7.36,4.75,5.18,1.38,11.21,2.99,11.21,9.73,0,4.94-3.42,9.54-11.97,9.54-5.65,0-9.78-2.04-12.49-5.03l2.71-3.66Z"/>
                              <path d="M825.48,514.67v-27.49h-9.83v-4.18h24.36v4.18h-9.78v27.49h-4.75Z"/>
                              <path d="M874.86,498.86c0-9.73,7.22-16.38,16.24-16.38,6.22,0,10.11,2.99,12.58,6.7l-4.04,2.14c-1.66-2.66-4.8-4.61-8.55-4.61-6.41,0-11.35,5.03-11.35,12.16s4.94,12.16,11.35,12.16c3.75,0,6.89-1.95,8.55-4.61l4.04,2.14c-2.52,3.7-6.36,6.7-12.58,6.7-9.02,0-16.24-6.65-16.24-16.38Z"/>
                              <path d="M940.2,514.67v-14.15h-17.52v14.15h-4.75v-31.67h4.75v13.3h17.52v-13.3h4.75v31.67h-4.75Z"/>
                              <path d="M961.48,483h4.8v19.14c0,5.41,2.99,8.88,8.55,8.88s8.5-3.47,8.5-8.88v-19.14h4.8v19.23c0,7.88-4.42,13.01-13.3,13.01s-13.34-5.18-13.34-12.96v-19.28Z"/>
                              <path d="M1022.92,514.67l-7.55-12.2h-5.94v12.2h-4.75v-31.67h13.34c6.03,0,10.16,3.89,10.16,9.73s-3.85,8.74-7.88,9.26l8.12,12.68h-5.51ZM1017.41,487.18h-7.98v11.11h7.98c3.42,0,5.89-2.23,5.89-5.56s-2.47-5.56-5.89-5.56Z"/>
                              <path d="M1042.2,498.86c0-9.73,7.22-16.38,16.24-16.38,6.22,0,10.11,2.99,12.58,6.7l-4.04,2.14c-1.66-2.66-4.8-4.61-8.55-4.61-6.41,0-11.35,5.03-11.35,12.16s4.94,12.16,11.35,12.16c3.75,0,6.89-1.95,8.55-4.61l4.04,2.14c-2.52,3.7-6.36,6.7-12.58,6.7-9.02,0-16.24-6.65-16.24-16.38Z"/>
                              <path d="M1107.54,514.67v-14.15h-17.52v14.15h-4.75v-31.67h4.75v13.3h17.52v-13.3h4.75v31.67h-4.75Z"/>
                            </g>`,
                vertical: `<g fill="TEXT_COLOR">
                             <!-- Ropes positioned for stacked layout -->
                             <path d="M224.05,442.76h68.49c18.29,0,32.7,4.74,43.23,14.21,10.52,9.47,15.79,22.46,15.79,38.98,0,10.69-2.23,20.08-6.68,28.17-4.45,8.1-10.73,14.41-18.82,18.94l34,61.69h-48.33l-26.23-54.16h-17.97v54.16h-43.47v-161.99ZM308.32,496.92c0-6.15-1.91-10.93-5.71-14.33-3.81-3.4-9.19-5.1-16.15-5.1h-18.94v38.61h18.94c7.12,0,12.55-1.7,16.27-5.1,3.72-3.4,5.59-8.09,5.59-14.09Z"/>
                             <path d="M562.36,442.76h68.49c18.46,0,32.95,4.78,43.47,14.33,10.52,9.56,15.79,22.67,15.79,39.34,0,11.17-2.39,20.89-7.16,29.14-4.78,8.26-11.58,14.66-20.4,19.19-8.83,4.53-19.23,6.8-31.21,6.8h-24.77v53.19h-44.2v-161.99ZM646.15,497.16c0-6.31-1.86-11.17-5.59-14.57-3.73-3.4-9.15-5.1-16.27-5.1h-17.73v39.34h17.73c7.12,0,12.55-1.7,16.27-5.1,3.72-3.4,5.59-8.26,5.59-14.57Z"/>
                             <path d="M711.48,442.76h115.12v37.89h-71.4v24.77h53.92v34.24h-53.92v27.2h77.23v37.89h-120.95v-161.99Z"/>
                             <path d="M930.29,558.85c0-4.05-1.62-7.29-4.86-9.71-3.24-2.43-9.64-5.02-19.19-7.77l-10.93-3.4c-12.96-3.72-23.16-9.43-30.6-17.12-7.45-7.69-11.17-17.61-11.17-29.75,0-10.2,2.55-19.22,7.65-27.08,5.1-7.85,12.22-14,21.37-18.46,9.14-4.45,19.79-6.68,31.94-6.68,11.49,0,22.46,1.86,32.91,5.59,10.44,3.73,19.07,8.91,25.86,15.54l-21.61,29.39c-10.85-9.39-22.67-14.09-35.46-14.09s-18.21,3.97-18.21,11.9c0,3.56,1.58,6.44,4.74,8.62,3.16,2.19,9.19,4.66,18.09,7.41l10.2,3.16c14.73,4.53,25.9,10.89,33.52,19.06,7.61,8.18,11.41,18.5,11.41,30.97,0,10.53-2.75,19.71-8.26,27.56-5.51,7.86-13.23,13.93-23.19,18.21-9.96,4.29-21.66,6.44-35.09,6.44-12.47,0-24.25-1.99-35.34-5.95-11.09-3.96-20.93-9.67-29.51-17.12l20.16-31.33c14.89,11.98,29.95,17.97,45.17,17.97,13.6,0,20.4-4.45,20.4-13.36Z"/>
                             <path d="M453.22,482.34c23.53,0,42.66,19.14,42.66,42.66s-19.14,42.66-42.66,42.66-42.66-19.14-42.66-42.66,19.14-42.66,42.66-42.66M453.22,437.84c-48.14,0-87.16,39.03-87.16,87.17s39.03,87.17,87.16,87.17,87.17-39.03,87.17-87.17-39.03-87.17-87.17-87.17h0Z"/>
                             <!-- First Baptist Church positioned below with correct coordinates -->
                             <path d="M249.94,667.08v-31.67h21.27v4.18h-16.52v9.26h16.19v4.18h-16.19v14.06h-4.75Z"/>
                             <path d="M285.84,667.08v-31.67h4.75v31.67h-4.75Z"/>
                             <path d="M325.39,667.08l-7.55-12.2h-5.94v12.2h-4.75v-31.67h13.34c6.03,0,10.16,3.89,10.16,9.73s-3.85,8.74-7.88,9.26l8.12,12.68h-5.51ZM319.89,639.59h-7.98v11.11h7.98c3.42,0,5.89-2.23,5.89-5.56s-2.47-5.56-5.89-5.56Z"/>
                             <path d="M346.76,658.96c2.14,2.37,5.56,4.46,9.97,4.46,5.13,0,6.93-2.61,6.93-4.89,0-3.32-3.61-4.27-7.64-5.32-5.08-1.33-10.97-2.8-10.97-9.26,0-5.22,4.61-9.02,11.21-9.02,4.89,0,8.74,1.57,11.54,4.42l-2.75,3.51c-2.42-2.56-5.74-3.7-9.16-3.7s-5.94,1.8-5.94,4.46c0,2.85,3.42,3.75,7.36,4.75,5.18,1.38,11.21,2.99,11.21,9.73,0,4.94-3.42,9.54-11.97,9.54-5.65,0-9.78-2.04-12.49-5.03l2.71-3.66Z"/>
                             <path d="M390.88,667.08v-27.49h-9.83v-4.18h24.36v4.18h-9.78v27.49h-4.75Z"/>
                             <path d="M441.59,667.08v-31.67h14.86c5.65,0,8.93,3.47,8.93,8.07,0,3.99-2.61,6.65-5.51,7.27,3.37.52,6.13,3.94,6.13,7.79,0,4.99-3.32,8.55-9.16,8.55h-15.24ZM446.34,648.85h9.21c3.18,0,4.94-1.99,4.94-4.61s-1.76-4.65-4.94-4.65h-9.21v9.26ZM446.34,662.9h9.45c3.32,0,5.32-1.9,5.32-4.99,0-2.61-1.8-4.89-5.32-4.89h-9.45v9.88Z"/>
                             <path d="M503.99,667.08l-2.56-6.55h-15.53l-2.56,6.55h-5.22l12.58-31.67h5.94l12.58,31.67h-5.22ZM493.64,639.54l-6.36,16.76h12.77l-6.41-16.76Z"/>
                             <path d="M522.51,667.08v-31.67h13.34c6.5,0,10.11,4.46,10.11,9.73s-3.66,9.73-10.11,9.73h-8.59v12.2h-4.75ZM535.23,639.59h-7.98v11.11h7.98c3.42,0,5.84-2.23,5.84-5.56s-2.42-5.56-5.84-5.56Z"/>
                             <path d="M568.09,667.08v-27.49h-9.83v-4.18h24.36v4.18h-9.78v27.49h-4.75Z"/>
                             <path d="M597.06,667.08v-31.67h4.75v31.67h-4.75Z"/>
                             <path d="M619.14,658.96c2.14,2.37,5.56,4.46,9.97,4.46,5.13,0,6.93-2.61,6.93-4.89,0-3.32-3.61-4.27-7.64-5.32-5.08-1.33-10.97-2.8-10.97-9.26,0-5.22,4.61-9.02,11.21-9.02,4.89,0,8.74,1.57,11.54,4.42l-2.75,3.51c-2.42-2.56-5.74-3.7-9.16-3.7s-5.94,1.8-5.94,4.46c0,2.85,3.42,3.75,7.36,4.75,5.18,1.38,11.21,2.99,11.21,9.73,0,4.94-3.42,9.54-11.97,9.54-5.65,0-9.78-2.04-12.49-5.03l2.71-3.66Z"/>
                             <path d="M663.25,667.08v-27.49h-9.83v-4.18h24.36v4.18h-9.78v27.49h-4.75Z"/>
                             <path d="M712.64,651.27c0-9.73,7.22-16.38,16.24-16.38,6.22,0,10.11,2.99,12.58,6.7l-4.04,2.14c-1.66-2.66-4.8-4.61-8.55-4.61-6.41,0-11.35,5.03-11.35,12.16s4.94,12.16,11.35,12.16c3.75,0,6.89-1.95,8.55-4.61l4.04,2.14c-2.52,3.7-6.36,6.7-12.58,6.7-9.02,0-16.24-6.65-16.24-16.38Z"/>
                             <path d="M777.98,667.08v-14.15h-17.52v14.15h-4.75v-31.67h4.75v13.3h17.52v-13.3h4.75v31.67h-4.75Z"/>
                             <path d="M799.25,635.41h4.8v19.14c0,5.41,2.99,8.88,8.55,8.88s8.5-3.47,8.5-8.88v-19.14h4.8v19.23c0,7.88-4.42,13.01-13.3,13.01s-13.34-5.18-13.34-12.96v-19.28Z"/>
                             <path d="M860.7,667.08l-7.55-12.2h-5.94v12.2h-4.75v-31.67h13.34c6.03,0,10.16,3.89,10.16,9.73s-3.85,8.74-7.88,9.26l8.12,12.68h-5.51ZM855.19,639.59h-7.98v11.11h7.98c3.42,0,5.89-2.23,5.89-5.56s-2.47-5.56-5.89-5.56Z"/>
                             <path d="M879.98,651.27c0-9.73,7.22-16.38,16.24-16.38,6.22,0,10.11,2.99,12.58,6.7l-4.04,2.14c-1.66-2.66-4.8-4.61-8.55-4.61-6.41,0-11.35,5.03-11.35,12.16s4.94,12.16,11.35,12.16c3.75,0,6.89-1.95,8.55-4.61l4.04,2.14c-2.52,3.7-6.36,6.7-12.58,6.7-9.02,0-16.24-6.65-16.24-16.38Z"/>
                             <path d="M945.32,667.08v-14.15h-17.52v14.15h-4.75v-31.67h4.75v13.3h17.52v-13.3h4.75v31.67h-4.75Z"/>
                           </g>`
            },
            none: ''
        };

        function initializeColorPickers() {
            const colorGroups = ['logoColors', 'textColors', 'exportBackgroundColors', 'topMarkColors'];

            colorGroups.forEach(groupId => {
                const container = document.getElementById(groupId);
                container.innerHTML = ''; // Clear existing children
                brandColors.forEach((color, index) => {
                    const colorDiv = document.createElement('div');
                    colorDiv.className = groupId === 'exportBackgroundColors' ? 'bg-color-option' : 'color-option';

                    // Special handling for the 'transparent_bg' option
                    if (groupId === 'exportBackgroundColors' && color === 'transparent_bg') {
                        colorDiv.style.background = `
                            linear-gradient(45deg, #f0f0f0 25%, transparent 25%),
                            linear-gradient(-45deg, #f0f0f0 25%, transparent 25%),
                            linear-gradient(45deg, transparent 75%, #f0f0f0 75%),
                            linear-gradient(-45deg, transparent 75%, #f0f0f0 75%)`;
                        colorDiv.style.backgroundSize = '10px 10px'; // Smaller checkers for the option box
                    } else {
                        colorDiv.style.backgroundColor = color;
                    }

                    colorDiv.onclick = () => selectColor(groupId, color, colorDiv);

                    // Set default selections
                    if (groupId === 'logoColors' && index === 2) { // Navy for bottom mark
                        colorDiv.classList.add('selected');
                    } else if (groupId === 'textColors' && index === 6) { // New Black for text
                        colorDiv.classList.add('selected');
                    } else if (groupId === 'exportBackgroundColors' && color === 'transparent_bg') { // NEW: Select transparent by default
                        colorDiv.classList.add('selected');
                    } else if (groupId === 'topMarkColors' && index === 0) { // Ropes Green for top mark
                        colorDiv.classList.add('selected');
                    }

                    container.appendChild(colorDiv);
                });
            });
        }

        function selectColor(groupId, color, element) {
            // Remove selection from siblings
            element.parentNode.querySelectorAll('.color-option, .bg-color-option').forEach(el => {
                el.classList.remove('selected');
            });
            element.classList.add('selected');

            // Update config
            switch(groupId) {
                case 'logoColors':
                    currentConfig.logoColor = color;
                    break;
                case 'textColors':
                    currentConfig.textColor = color;
                    break;
                case 'exportBackgroundColors':
                    currentConfig.exportBackgroundColor = color;
                    break;
                case 'topMarkColors':
                    currentConfig.topMarkColor = color;
                    break;
            }

            updatePreview();
        }

        function updateUIForLogoMark(logoMark) {
            const topMarkGroup = document.getElementById('topMarkColorGroup');
            const logoColorLabel = document.getElementById('logoColorLabel');

            if (logoMark === 'fbcMark') {
                topMarkGroup.style.display = 'block'; // Show top mark color for fbcMark
                logoColorLabel.textContent = 'Bottom Mark Color'; // Label for fbcMark's bottom color
            } else { // For 'steeple' and any future 1-color logomarks
                topMarkGroup.style.display = 'none'; // Hide top mark color
                logoColorLabel.textContent = 'Logo Color'; // Change label to "Logo Color"
            }
        }

        // Helper function to get the combined bounding box of SVG elements
// This needs to be called on the *raw* elements before any centering transforms are applied.
function getCombinedBoundingBox(elements) {
    // Create a temporary SVG element to hold a copy of the content
    // This allows us to get the bounding box of the un-transformed content
    const tempSvg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
    document.body.appendChild(tempSvg); // Needs to be in DOM for getBBox()

    let tempGroup = document.createElementNS("http://www.w3.org/2000/svg", "g");
    tempSvg.appendChild(tempGroup);

    // Clone content without current transforms
    elements.forEach(el => {
        if (el && el.innerHTML.trim() !== '') {
            const clone = el.cloneNode(true);
            clone.removeAttribute('transform'); // Remove any existing transforms on the clones
            tempGroup.appendChild(clone);
        }
    });

    try {
        const bbox = tempGroup.getBBox();
        document.body.removeChild(tempSvg); // Clean up temp SVG
        return bbox;
    } catch (e) {
        document.body.removeChild(tempSvg); // Clean up even on error
        console.warn('Could not get BBox for elements:', elements, e);
        return null;
    }
}


function updatePreview() {
    const logoSVG = document.getElementById('logoSVG');
    let mainContentGroup = document.getElementById('mainContentGroup');
    const logoGroup = document.getElementById('logoGroup');
    const textGroup = document.getElementById('textGroup');
    const previewArea = document.querySelector('.logo-preview');

    // Create the mainContentGroup if it doesn't exist
    if (!mainContentGroup) {
        mainContentGroup = document.createElementNS("http://www.w3.org/2000/svg", "g");
        mainContentGroup.id = 'mainContentGroup';
        logoSVG.appendChild(mainContentGroup);
    }

    // Move logoGroup and textGroup to be children of mainContentGroup
    // This ensures that `getBBox()` on logoGroup/textGroup reflects their raw, un-transformed state
    // and that `mainContentGroup` can apply a single transformation to all content.
    if (!mainContentGroup.contains(logoGroup)) {
        mainContentGroup.appendChild(logoGroup);
    }
    if (!mainContentGroup.contains(textGroup)) {
        mainContentGroup.appendChild(textGroup);
    }

    // Reset inner content and transforms before adding new SVG
    logoGroup.innerHTML = '';
    textGroup.innerHTML = '';
    mainContentGroup.setAttribute('transform', ''); // Clear previous transform


    // Update preview background based on export background color
    if (currentConfig.exportBackgroundColor === 'transparent_bg') {
        previewArea.style.background = `
            linear-gradient(45deg, #f0f0f0 25%, transparent 25%),
            linear-gradient(-45deg, #f0f0f0 25%, transparent 25%),
            linear-gradient(45deg, transparent 75%, #f0f0f0 75%),
            linear-gradient(-45deg, transparent 75%, #f0f0f0 75%)`;
        previewArea.style.backgroundSize = '20px 20px';
        previewArea.style.backgroundPosition = '0 0, 0 10px, 10px -10px, -10px 0px';
    } else {
        previewArea.style.background = currentConfig.exportBackgroundColor;
        previewArea.style.backgroundSize = 'auto';
        previewArea.style.backgroundPosition = 'initial';
    }

    // Add logo mark using pre-positioned coordinates
    if (logoMarks[currentConfig.logoMark]) {
        let rawLogoSVG;
        // ... (Your existing logic to get rawLogoSVG based on logoMark and layout) ...
        if (currentConfig.logoMark === 'fbcMark') {
            if (currentConfig.layout === 'horizontal') {
                rawLogoSVG = logoMarks[currentConfig.logoMark].horizontal;
            } else if (currentConfig.layout === 'vertical') {
                rawLogoSVG = logoMarks[currentConfig.logoMark].vertical;
            } else if (currentConfig.layout === 'logoOnly') {
                rawLogoSVG = logoMarks[currentConfig.logoMark].logoOnly;
            }

            if (typeof rawLogoSVG === 'string') {
                const logoSVGContent = rawLogoSVG
                    .replace(/BOTTOM_COLOR/g, currentConfig.logoColor)
                    .replace(/TOP_COLOR/g, currentConfig.topMarkColor);
                logoGroup.innerHTML = logoSVGContent;
            } else {
                console.error('Invalid SVG string for fbcMark layout:', currentConfig.layout, rawLogoSVG);
            }
        } else if (logoMarks[currentConfig.logoMark].horizontal) {
            if (currentConfig.layout === 'horizontal') {
                rawLogoSVG = logoMarks[currentConfig.logoMark].horizontal;
            } else if (currentConfig.layout === 'vertical') {
                rawLogoSVG = logoMarks[currentConfig.logoMark].vertical;
            } else if (currentConfig.layout === 'logoOnly') {
                rawLogoSVG = logoMarks[currentConfig.logoMark].logoOnly;
            }

            if (typeof rawLogoSVG === 'string') {
                const logoSVGContent = rawLogoSVG.replace(/LOGO_COLOR/g, currentConfig.logoColor);
                logoGroup.innerHTML = logoSVGContent;
            } else {
                console.error(`Invalid SVG string for ${currentConfig.logoMark} layout:`, currentConfig.layout, rawLogoSVG);
            }
        } else {
            rawLogoSVG = logoMarks[currentConfig.logoMark];
            if (typeof rawLogoSVG === 'string') {
                const logoSVGContent = rawLogoSVG.replace(/LOGO_COLOR/g, currentConfig.logoColor);
                logoGroup.innerHTML = logoSVGContent;
            } else {
                console.error('Invalid SVG string for logoMark:', currentConfig.logoMark, rawLogoSVG);
            }
        }
    }

    // Add text using pre-positioned coordinates
    if (textMarks[currentConfig.textOption] && currentConfig.layout !== 'logoOnly') {
        let rawTextSVG = '';
        // ... (Your existing logic to get rawTextSVG based on textOption and layout) ...
        if (currentConfig.textOption === 'ropes' || currentConfig.textOption === 'ropesFBC') {
            if (currentConfig.layout === 'horizontal') {
                rawTextSVG = textMarks[currentConfig.textOption].horizontal;
            } else if (currentConfig.layout === 'vertical') {
                rawTextSVG = textMarks[currentConfig.textOption].vertical;
            } else {
                rawTextSVG = textMarks[currentConfig.textOption].horizontal; // fallback
            }
        } else {
            rawTextSVG = textMarks[currentConfig.textOption];
        }

        if (typeof rawTextSVG === 'string') {
            const textSVGContent = rawTextSVG.replace(/TEXT_COLOR/g, currentConfig.textColor);
            textGroup.innerHTML = textSVGContent;
        } else {
            console.error('Invalid text SVG string for option:', currentConfig.textOption, rawTextSVG);
        }
    }


    // --- DYNAMIC CENTERING AND SCALING FOR PREVIEW ---
    const combinedBBox = getCombinedBoundingBox([logoGroup, textGroup]);

    if (combinedBBox && combinedBBox.width > 0 && combinedBBox.height > 0) {
        const svgCanvasWidth = 1200; // Original SVG width
        const svgCanvasHeight = 800; // Original SVG height
        const padding = 50; // Padding from the SVG edge

        const contentWidth = combinedBBox.width;
        const contentHeight = combinedBBox.height;

        // Calculate scale factor
        const scaleX = (svgCanvasWidth - 2 * padding) / contentWidth;
        const scaleY = (svgCanvasHeight - 2 * padding) / contentHeight;
        const scale = Math.min(scaleX, scaleY);

        // Calculate translation to center the scaled content
        const translateX = (svgCanvasWidth / 2) - (combinedBBox.x + contentWidth / 2) * scale;
        const translateY = (svgCanvasHeight / 2) - (combinedBBox.y + contentHeight / 2) * scale;

        mainContentGroup.setAttribute('transform', `translate(${translateX} ${translateY}) scale(${scale})`);

        // Important: Keep the main logoSVG viewBox as 0 0 1200 800
        // The scaling and centering is now handled by the 'mainContentGroup' transform.
        logoSVG.setAttribute('viewBox', `0 0 ${svgCanvasWidth} ${svgCanvasHeight}`);
        logoSVG.setAttribute('width', svgCanvasWidth); // Ensure explicit width/height for preview
        logoSVG.setAttribute('height', svgCanvasHeight);

    } else {
        // If no content, reset transforms and viewBox
        mainContentGroup.setAttribute('transform', '');
        logoSVG.setAttribute('viewBox', '0 0 1200 800');
        logoSVG.setAttribute('width', '1200');
        logoSVG.setAttribute('height', '800');
    }
}

// Event listeners
document.getElementById('logoMark').onchange = function () {
    currentConfig.logoMark = this.value;
    updateUIForLogoMark(this.value);
    updatePreview();
};

document.getElementById('textOption').onchange = function () {
    currentConfig.textOption = this.value;
    updatePreview();
};

document.querySelectorAll('.layout-btn').forEach(btn => {
    btn.onclick = function () {
        document.querySelectorAll('.layout-btn').forEach(b => b.classList.remove('selected'));
        this.classList.add('selected');
        currentConfig.layout = this.dataset.layout;
        updatePreview();
    };
});

        // Download functions
        function downloadPNG(width) {
    const svg = document.getElementById('logoSVG');

    // Temporarily set the SVG's viewBox to capture the transformed content correctly
    // This is crucial for rendering content that has transforms applied to its groups
    const originalViewBox = svg.getAttribute('viewBox');
    const originalWidth = svg.getAttribute('width');
    const originalHeight = svg.getAttribute('height');

    // Set a large enough viewBox for the SVG to encompass everything for rendering
    // A safe default could be the current content's bounding box or a fixed large value.
    // However, since updatePreview already scales and positions elements within 0 0 1200 800,
    // we just need to ensure the SVG element itself captures that.
    svg.setAttribute('viewBox', `0 0 1200 800`); // Ensure consistent viewBox for serialization
    svg.setAttribute('width', '1200'); // Ensure consistent dimensions for serialization
    svg.setAttribute('height', '800');


    const svgData = new XMLSerializer().serializeToString(svg);
    const svgBlob = new Blob([svgData], {type: 'image/svg+xml;charset=utf-8'});
    const svgUrl = URL.createObjectURL(svgBlob);

    const img = new Image();
    img.onload = function() {
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');

        const aspectRatio = img.height / img.width; // Should be 800/1200 = 0.666
        canvas.width = width;
        canvas.height = width * aspectRatio; // Scales proportionally

        ctx.drawImage(img, 0, 0, canvas.width, canvas.height); // Draw the scaled/centered SVG directly

        canvas.toBlob(function(blob) {
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ropes-logo-${width}px.png`;
            a.click();
            URL.revokeObjectURL(url);
        });

        URL.revokeObjectURL(svgUrl);

        // Restore original SVG attributes (for preview if still visible)
        svg.setAttribute('viewBox', originalViewBox);
        svg.setAttribute('width', originalWidth);
        svg.setAttribute('height', originalHeight);
    };
    img.src = svgUrl;
}

function downloadJPG(format) {
    const svg = document.getElementById('logoSVG');

    // Temporarily set the SVG's viewBox to capture the transformed content correctly
    const originalViewBox = svg.getAttribute('viewBox');
    const originalWidth = svg.getAttribute('width');
    const originalHeight = svg.getAttribute('height');

    svg.setAttribute('viewBox', `0 0 1200 800`); // Ensure consistent viewBox for serialization
    svg.setAttribute('width', '1200'); // Ensure consistent dimensions for serialization
    svg.setAttribute('height', '800');


    const svgData = new XMLSerializer().serializeToString(svg);
    const svgBlob = new Blob([svgData], {type: 'image/svg+xml;charset=utf-8'});
    const svgUrl = URL.createObjectURL(svgBlob);

    const img = new Image();
    img.onload = function() {
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');

        let targetWidth, targetHeight;

        switch(format) {
            case 'square':
                targetWidth = targetHeight = 1080;
                break;
            case 'landscape':
                targetWidth = 1920;
                targetHeight = 1080;
                break;
            case 'portrait':
                targetWidth = 1080;
                targetHeight = 1920;
                break;
        }

        canvas.width = targetWidth;
        canvas.height = targetHeight;

        // Determine the background color for JPG
        let bgColorForJPG = currentConfig.exportBackgroundColor;
        if (bgColorForJPG === 'transparent_bg') {
            bgColorForJPG = '#ffffff'; // If transparent is selected for JPG, default to solid white
        }

        ctx.fillStyle = bgColorForJPG;
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // Calculate scaling to fit the logo (which is already centered within 1200x800)
        // into the new canvas dimensions while maintaining aspect ratio.
        const svgContentAspectRatio = 1200 / 800; // The aspect ratio of your "prepared" SVG area
        const canvasAspectRatio = targetWidth / targetHeight;

        let drawWidth, drawHeight;
        if (svgContentAspectRatio > canvasAspectRatio) {
            // SVG content is wider than canvas, constrain by width
            drawWidth = targetWidth;
            drawHeight = targetWidth / svgContentAspectRatio;
        } else {
            // SVG content is taller than canvas, constrain by height
            drawHeight = targetHeight;
            drawWidth = targetHeight * svgContentAspectRatio;
        }

        const x = (targetWidth - drawWidth) / 2;
        const y = (targetHeight - drawHeight) / 2;

        ctx.drawImage(img, x, y, drawWidth, drawHeight); // Draw the prepared SVG onto the canvas

        canvas.toBlob(function(blob) {
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ropes-logo-${format}.jpg`;
            a.click();
            URL.revokeObjectURL(url);
        }, 'image/jpeg', 0.95);

        URL.revokeObjectURL(svgUrl);

        // Restore original SVG attributes
        svg.setAttribute('viewBox', originalViewBox);
        svg.setAttribute('width', originalWidth);
        svg.setAttribute('height', originalHeight);
    };
    img.src = svgUrl;
}

        // Initialize the app
        initializeColorPickers();
        updatePreview();
    </script>
</body>
</html>